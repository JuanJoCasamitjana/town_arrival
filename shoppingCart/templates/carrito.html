{% extends 'base.html' %}
{% block content %}
<body>
    
    <h1>Carrito de Compras</h1>
    {% if cosas %}  
    <p> Si el total supera los 20€ no se aplicarán los gastos de gestión</p>
    <!-- Mostrar productos en el carrito -->
    <table class="table table-striped">
        <tr>
            {% for alquiler_info in productos_en_carrito %}
            <td>{{ alquiler_info.alquiler.alquilo.titulo }}</td>
            <td>{{ alquiler_info.alquiler.alquilo.precioPorDia }} € por día</td>
            <td>{{ alquiler_info.alquiler.FechaInicio }}</td>
            <td>{{ alquiler_info.alquiler.FechaFinal }}</td>
            <td>
                <form method="post" action="{% url 'actualizar_dias_alquiler' alquiler_info.alquiler.id %}">
                    {% csrf_token %}
                    <input type="number" name="nuevos_dias" value="{{ alquiler_info.dias_alquiler }}">
                    <button type="submit">Actualizar días</button>
                </form>
            </td>
            <td><a class="btn btn-secondary" href="{% url 'eliminar_del_carrito' alquiler_info.alquiler.id %}">Eliminar</a></td>
        {% endfor %}
        </tr>
        <tr class="font-weight-bold">
            <td>Total</td>
            <td>{{ total_carrito }} €</td>
        </tr>
    </table>
    {% if gestion %}
        <p>Añadido 10€ de gastos de gestion al no superar los 20€ en total</p>    
        <p>Precio original: ${{total_carrito}}
    {% endif %}
    <!-- Mostrar el total del carrito -->
    <p>Total: €{{ total_post_gestion }}</p>
            
    <form method="post" action="{% url 'pagos' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">Pago Contrarrembolso</button>
    </form>
    <form method="post" action="{% url 'carrito' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">Pago con tarjeta</button>
    </form>
    {% else %}
    <p>Carrito vacío</p>
    {% endif %}
    
</body>

{% endblock %}
